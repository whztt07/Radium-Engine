<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Radium Engine: Radium Engine programmer manual</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSsymbols.js", "TeX/AMSmath.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Radium Engine
   &#160;<span id="projectnumber">28bf594254a312693a0e8cbb8f95fa3e00d4a506</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__home_travis_build_STORM-IRIT_Radium-Engine_Docs_model.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Radium Engine programmer manual </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Source code organization</h2>
<ul>
<li><code>src</code> contains the main source code of the engine libs<ul>
<li><code>Core</code> : the Core module (static library) contains the foundation classes such as math classes, containers, adapters to the standard library, etc.</li>
<li><code>Engine</code> the Engine module (static library) contains all graphics related code and engine subsystems running.</li>
<li><code>GuiBase</code> has the Qt-based GUI classes.</li>
</ul>
</li>
<li><code>Plugins</code> contains the plugins which add Systems and Components to the engine.</li>
<li><code>Shaders</code> contains the OpenGL Shaders used by the renderer.</li>
<li><code>Applications</code> contains applications build with the engine. Currently it contains a minimal example application and the full-fledged <code>main-app</code></li>
<li><code>3rdPartyLibs</code> contains any library dependency. CMake will automatically look in this folder to find the libraries if they are not installed on your system.</li>
</ul>
<h3>Import and export</h3>
<p>Core and Engine (and the plugins) are compiled as dynamic libraries, therefore you must be careful about which symbols need exporting, especially on Windows. Every module has a specific header file (<code><a class="el" href="RaCore_8hpp.html">RaCore.hpp</a></code> for Core) which must be included first in all other headers of the module. In particular it defines the <code>*_API</code> macros which help exporting and importing symbols on Windows.</p>
<h2>Core Libs</h2>
<p><code>Core</code> contains most of the basic code on which the rest of the software is built.</p>
<ul>
<li><code><a class="el" href="CoreMacros_8hpp.html">CoreMacros.hpp</a></code> has definitions of basic types, build configuration and useful macros.</li>
<li><code>Math</code> is our math library, which is a wrapper around <em><a class="el" href="namespaceEigen.html">Eigen</a></em>. The most useful files are <code><a class="el" href="Math_8hpp.html">Math.hpp</a></code> which has mathematical constants and simple functions, and <code><a class="el" href="LinearAlgebra_8hpp.html">LinearAlgebra.hpp</a></code> which contains the type definitions of most basic vector and matrix types.</li>
<li><code>Containers</code> has some specially useful std-like containers, most importantly <code><a class="el" href="VectorArray_8hpp.html">VectorArray.hpp</a></code> which defines a dynamic array of vectors with both a<code>std::vector</code>-like interface and compatibility with <a class="el" href="namespaceEigen.html">Eigen</a>.</li>
<li><code>Mesh</code> contains our basic mesh geometry primitives, including the representation of a simple triangle mesh and many functions to operate on geometry.</li>
<li><code>String</code> contains utilities extending <code>std::string</code>.</li>
<li><code><a class="el" href="classLog.html">Log</a></code> is a wrapper around the header-only <em>EasyLogger</em> library which allows us to log various events.</li>
<li><code>Time</code> contains utilities around <code>std::chrono</code> for precise timings.</li>
<li><code>Tasks</code> contains the definition for the basic Tasks system and the task queue.</li>
<li><code>Utils</code> contains generic utilities such as a Singleton template.</li>
</ul>
<h2>Engine Object Model</h2>
<h3>Entities</h3>
<p><em>Entities</em> are the base object manipulated by the engine. You can think of them as "game objects", something that represent an object in the scene. Entity data include a world space to object space transform and a list of <em>Components</em></p>
<p>The entity's role is only to hold together this transform and the list of components. The entity uses double buffering to prevent transforms from being updated more than once per frame.</p>
<p>When creating an entity, if you set its transform, <em>do not forget</em> to call <code>Entity::swapTransformBuffers</code>, this might prevent you some headache. Example : ``` <a class="el" href="classRa_1_1Engine_1_1Entity.html" title="An entity is an scene element. It ties together components with a transform. ">Ra::Engine::Entity</a>* entity = theEntityManager-&gt;getOrCreate( "MyEntity" ); <a class="el" href="namespaceRa_1_1Core.html#a78aad321111ea0b0aeb30f27c161c1b3">Ra::Core::Transform</a> transform( Ra::Core::Transform::Identity() ); transform.translation = Ra::Core::Vector3( 42, 13, 37 ); entity-&gt;setTransform( transform ); entity-&gt;swapTransformBuffers(); ```</p>
<h3>Systems and Components</h3>
<p>Each <em>Component</em> represent an aspect of an <em>Entity</em> to a particular engine subsystem. For example, an animated character may have a skeleton(animation component), a high-resolution mesh (display component) and simplified convex shape for collision detection (physics component).</p>
<p>Each Component is related to a <em>System</em>. The Engine loads several Systems (statically or from a plugin) and they keep the Components of all Entities in the scene updated.</p>
<p>For example, an Entity may have a Physics Component (which represent its collision shape), and the engine's corresponding Physics System will update its position according to the physics engine's result.</p>
<h3>Frame and Tasks</h3>
<p>At each frame, the main loop first starts the renderer, then each System is given the opportunity to add <em>Tasks</em> to the task queue. Tasks are processed in parallel during every frame. They can have dependencies between them (e.g. the physics update can wait for the animation update to complete).</p>
<p>A Task must implement the interface <code>Core::Task</code> which defines a <code>process()</code> function which will be called when the task is executed. However for most cases, it is usually convenient to use a <code>FunctionTask</code> which takes an instance of <code>std::function</code> (which will be called by the <code>process()</code> method). Calling an object's member function in a task is thus easily achieved by using <code>std::bind()</code> to create the function object.</p>
<p>When a task is added, the task queue assumes ownership of the task and returns a <code>TaskID</code> which identifies the task.</p>
<p>Dependencies between tasks can be specified either as <em>immediate</em> dependencies or <em>pending</em> dependencies. Immediate dependencies are dependencies between tasks which are already present in the task queue. Adding a dependency with <code>TaskkQueue::addDependency()</code> takes two arguments, the predecessor and the successor task, and the task queue will ensure that the successor task must be executed after all its predecesors have finished. In <code>addDependency()</code>, tasks can be identified with either a <code>TaskID</code> or a name; at least one of the arguments must be a <code>TaskID</code>. If a name is given, <em>all</em> tasks matching with the name will be added as dependencies.</p>
<p>Since the order in which the systems are called is unspecified, a system may want to add a dependency to a task that is not yet present. Pending dependencies solve this problem by specifying a dependency between a <code>TaskID</code>and a name (which may not be present in the task queue). Pending dependencies are resolved just before the task queue starts executing all tasks.</p>
<h3>Rendering</h3>
<p>Each Component may have some <em>RenderObjects</em> (aka Drawables) which are (usually) OpenGL objects. When a Component has changed it needs to tell its drawables to update their internal data (such as OpenGL VBOs). Render objects are stored together by the <em>render object manager</em> for efficiency, thus components only store an index to reference their render objects.</p>
<p>The Render Objects are drawn by the <em>Renderer</em> which may live in a separated thread. Each frame it grabs all the drawables (which should be double-buffered in case we are mid-VBO update) and calls <code>draw()</code> on them.</p>
<p>(TODO : a nice class schema).</p>
<h3>ItemEntry : Handles to engine objects</h3>
<p>The structure <code>ItemEntry</code> acts as a general identifier for all three levels of engine objects (entities, components and render objects) by storing a handle to the three objects (a pointer or an index for render objects). An entry representing an entity will have its entity handle set and the other two invalid; an entry representing a component will have the component handle set and the entity handle set to the entity owning the component. Similarly a render object entry will have all three handles sets . Any other combination is invalid.</p>
<p>Item entries are mainly used to harmonize the interface to manipulate objects in the GUI.</p>
<h3>Object manipulation and editable transforms</h3>
<p>Components have an interface through which transforms can be edited with three functions :</p>
<ul>
<li><code>canEdit()</code></li>
<li><code>getTransform()</code></li>
<li><code>setTransform()</code></li>
</ul>
<p>Each of these functions takes a render object index as argument, as sometimes a component exposes multiple objects whose transform can be edited. Function <code>canEdit()</code> tells whether a given idnex can be used as a handle for the other two functions.</p>
<h3>The system Entity and Debug Display.</h3>
<p>One Entity is always created when the engine starts, called the System Entity. Implemented as a singleton, this entity acts as a special object that the engine can use internally to display elements not related to any other Entity. The System Entity is fixed to the world and cannot be moved.</p>
<p>In particular it is expected that <a class="el" href="namespaceUI.html">UI</a> elements (e.g. Gizmos) should be attached to the <a class="el" href="namespaceUI.html">UI</a> component. The Debug Component is useful to display debug primitives which can be useful for graphic debugging. A series of macros <code>RA_DISPLAY_...</code> are defined to conveniently add basic display objects such as points, vectors, lines or 3D frames from anywhere in the code. A compile-time switch (<code>RA_DISABLE_DEBUG_DISPLAY</code>) can be activated to disable this feature.</p>
<h2>The plugin framework</h2>
<p>Entities and components have been designed so that the engine is modular in terms of features. It is expected that most interesting works will be done by Systems defined in <em>Plugins</em>. Each plugin can define its System (and the corresponding Components).</p>
<p>We use a compile-time plugins loading mechanism. When running <code>cmake</code>, it will list the contents of the <code>src/Plugins/</code> directory and add them to be compiled with the projet, and automatically generate the code to include the plugins Systems in the main application.</p>
<h3>Requirements</h3>
<p>For this automated build to work the plugins are required to follow these requirements</p>
<ul>
<li>The plugin code must be in a subfolder of the <code>src/Plugins/</code> directory.</li>
<li>The folder name is taken to be the <em>base name</em> of the plugin. If the directory name is <code>BaseName</code>, then<ul>
<li>Plugin code must be in <code>namespace BaseNamePlugin</code></li>
<li>The system defined by the plugin must be named <code>BaseNamePlugin::BaseNameSystem</code></li>
<li>It must be defined in a header located at the top of the plugin subfolder, named <code>BaseNameSystem.hpp</code> (its full path should be <code>src/Plugins/Basename/BasenameSystem.hpp</code>)</li>
<li>The system must inherit from <code>Engine::System</code> and have a default empty constructor.</li>
</ul>
</li>
</ul>
<h3>Default plugins</h3>
<p>See the structure of the default plugins for an example of a working plugin. So far three default plugin exist:</p>
<ul>
<li><em>Animation</em> handles an animation skeleton and can play keyframed animations.</li>
<li><em>Skinning</em> uses a geometric skinning method (like linear blend skinning or dual quaternion). See also the Radium-PluginExample project: <a href="https://github.com/STORM-IRIT/Radium-PluginExample">https://github.com/STORM-IRIT/Radium-PluginExample</a> for ToonShader and LaplacianSmoothing. </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Nov 19 2018 21:15:52 for Radium Engine by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
